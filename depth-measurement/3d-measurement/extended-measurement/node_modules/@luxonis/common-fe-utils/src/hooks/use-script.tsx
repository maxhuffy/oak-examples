import React from 'react';

export interface UseScriptOptions {
  removeOnUnmount?: boolean;
}

export const useScript = (src: string, options?: UseScriptOptions): void => {
  React.useEffect(() => {
    let scriptNode: HTMLScriptElement | null = document.querySelector(`script[src="${src}"]`);

    // eslint-disable-next-line github/no-dynamic-script-tag
    scriptNode = document.createElement('script');
    scriptNode.src = src;
    scriptNode.async = true;
    scriptNode.defer = true;
    document.body.appendChild(scriptNode);

    return () => {
      if (scriptNode && options?.removeOnUnmount) {
        scriptNode.remove();
        scriptNode = null;
      }
    };
  }, [src, options?.removeOnUnmount]);
};
